<!DOCTYPE html>
<html>
<head>
    <title>PWA Check</title>
</head>
<body>
    <h1>PWA Configuration Check</h1>
    <div id="results"></div>
    
    <script>
        async function checkPWA() {
            const results = [];
            
            // 1. Check manifest
            try {
                const response = await fetch('/manifest.json');
                if (response.ok) {
                    const manifest = await response.json();
                    results.push({ test: 'Manifest exists', passed: true, details: manifest.name });
                } else {
                    results.push({ test: 'Manifest exists', passed: false, details: 'Status: ' + response.status });
                }
            } catch (e) {
                results.push({ test: 'Manifest exists', passed: false, details: e.message });
            }
            
            // 2. Check icons
            const icons = ['/icon-192.png', '/icon-512.png', '/favicon.ico', '/apple-touch-icon.png'];
            for (const icon of icons) {
                try {
                    const response = await fetch(icon);
                    results.push({ 
                        test: `Icon: ${icon}`, 
                        passed: response.ok,
                        details: response.ok ? 'Found' : 'Missing' 
                    });
                } catch (e) {
                    results.push({ test: `Icon: ${icon}`, passed: false, details: 'Error' });
                }
            }
            
            // 3. Check meta tags
            const metaChecks = [
                { name: 'viewport', selector: 'meta[name="viewport"]' },
                { name: 'theme-color', selector: 'meta[name="theme-color"]' },
                { name: 'manifest', selector: 'link[rel="manifest"]' },
                { name: 'apple-touch-icon', selector: 'link[rel="apple-touch-icon"]' }
            ];
            
            // Load main page to check meta tags
            const mainPage = await fetch('/');
            const html = await mainPage.text();
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            
            for (const check of metaChecks) {
                const element = doc.querySelector(check.selector);
                results.push({
                    test: `Meta: ${check.name}`,
                    passed: !!element,
                    details: element ? 'Found' : 'Missing'
                });
            }
            
            // Display results
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = results.map(r => `
                <div style="margin: 10px; padding: 10px; background: ${r.passed ? '#d4edda' : '#f8d7da'}; border: 1px solid ${r.passed ? '#c3e6cb' : '#f5c6cb'}; border-radius: 5px;">
                    ${r.passed ? '‚úÖ' : '‚ùå'} ${r.test}<br>
                    <small>${r.details}</small>
                </div>
            `).join('');
            
            // Summary
            const passed = results.filter(r => r.passed).length;
            const total = results.length;
            const summary = document.createElement('div');
            summary.style.cssText = 'margin: 20px; padding: 20px; background: #fff3cd; border: 2px solid #ffeaa7; border-radius: 10px;';
            summary.innerHTML = `
                <h3>${passed}/${total} tests passed</h3>
                <p>${passed === total ? 'üéâ PWA ready!' : '‚ö†Ô∏è Fix the issues above'}</p>
                ${passed < total ? `<p><strong>Fix these files in ROOT folder:</strong>
                <ul>
                    <li>manifest.json</li>
                    <li>icon-192.png</li>
                    <li>icon-512.png</li>
                    <li>favicon.ico</li>
                    <li>apple-touch-icon.png</li>
                </ul></p>` : ''}
            `;
            resultsDiv.appendChild(summary);
        }
        
        checkPWA();
    </script>
</body>
</html>
